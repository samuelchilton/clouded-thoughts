var b=Object.defineProperty;var P=(n,t,i)=>t in n?b(n,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[t]=i;var a=(n,t,i)=>P(n,typeof t!="symbol"?t+"":t,i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&e(h)}).observe(document,{childList:!0,subtree:!0});function i(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function e(s){if(s.ep)return;s.ep=!0;const o=i(s);fetch(s.href,o)}})();class E{constructor(t,i,e,s,o="I am a cloud"){a(this,"x");a(this,"y");a(this,"vx");a(this,"vy");a(this,"width");a(this,"height");a(this,"element");a(this,"isDragging",!1);a(this,"dragOffsetX",0);a(this,"dragOffsetY",0);this.x=t,this.y=i,this.vx=e,this.vy=s,this.width=600,this.height=480,this.element=document.createElement("div"),this.element.className="cloud",this.element.style.width=`${this.width}px`,this.element.style.height=`${this.height}px`,this.element.style.cursor="grab";const h=document.createElement("div");h.className="cloud-body",h.style.top="180px",this.element.appendChild(h);for(let r=1;r<=5;r++){const d=document.createElement("div");d.className=`cloud-puff cloud-puff-${r}`,this.element.appendChild(d)}const c=document.createElement("span");c.className="cloud-text",c.textContent=o,this.element.appendChild(c),this.setupDragging(),this.updatePosition()}setupDragging(){this.element.addEventListener("mousedown",t=>{this.isDragging=!0,this.dragOffsetX=t.clientX-this.x,this.dragOffsetY=t.clientY-this.y,this.element.style.cursor="grabbing",t.preventDefault()}),document.addEventListener("mousemove",t=>{this.isDragging&&(this.x=t.clientX-this.dragOffsetX,this.y=t.clientY-this.dragOffsetY,this.updatePosition())}),document.addEventListener("mouseup",()=>{this.isDragging&&(this.isDragging=!1,this.element.style.cursor="grab")})}updatePosition(){this.element.style.transform=`translate(${this.x}px, ${this.y}px)`}update(){this.x+=this.vx,this.y+=this.vy,this.updatePosition()}getBounds(){return{left:this.x,right:this.x+this.width,top:this.y,bottom:this.y+this.height}}}function M(n,t,i,e){let r,d,l=0;const f=100;do r=Math.random()*(n-600),d=Math.random()*(t-480),l++;while(l<f&&i.some(m=>{const w=Math.abs(m.x-r),x=Math.abs(m.y-d);return w<650&&x<530}));const p=Math.random()*Math.PI*2,u=.15+Math.random()*(.4-.15),v=Math.cos(p)*u,y=Math.sin(p)*u;return new E(r,d,v,y,e)}function X(n,t,i){const e=n.getBounds();e.left<=0&&(n.x=0,n.vx=Math.abs(n.vx)),e.right>=t&&(n.x=t-n.width,n.vx=-Math.abs(n.vx)),e.top<=0&&(n.y=0,n.vy=Math.abs(n.vy)),e.bottom>=i&&(n.y=i-n.height,n.vy=-Math.abs(n.vy))}function Y(n,t){const i=n.getBounds();for(const e of t){const s=i.left<e.right&&i.right>e.left,o=i.top<e.bottom&&i.bottom>e.top;if(s&&o){const h=i.right-e.left,c=e.right-i.left,r=i.bottom-e.top,d=e.bottom-i.top,l=Math.min(h,c,r,d);l===h?(n.x=e.left-n.width,n.vx=-Math.abs(n.vx)):l===c?(n.x=e.right,n.vx=Math.abs(n.vx)):l===r?(n.y=e.top-n.height,n.vy=-Math.abs(n.vy)):(n.y=e.bottom,n.vy=Math.abs(n.vy))}}}const g="https://clouded-thoughts-backend-production.up.railway.app/thoughts";class L{constructor(){a(this,"clouds",[]);a(this,"sky");a(this,"viewport");a(this,"canvasWidth");a(this,"canvasHeight");a(this,"blockElements",[]);a(this,"panX",0);a(this,"panY",0);a(this,"isPanning",!1);a(this,"panStartX",0);a(this,"panStartY",0);const t=document.getElementById("sky"),i=document.getElementById("viewport");if(!t||!i)throw new Error("Required elements not found");this.sky=t,this.viewport=i,this.canvasWidth=window.innerWidth*3,this.canvasHeight=window.innerHeight*3,this.panX=-window.innerWidth,this.panY=-window.innerHeight,this.updatePan(),this.init(),this.setupPanning(),this.setupRecenterButton(),this.setupResizeHandler(),this.startAnimationLoop()}setupRecenterButton(){const t=document.getElementById("recenter-btn");t&&t.addEventListener("click",()=>{this.panX=-window.innerWidth,this.panY=-window.innerHeight,this.updatePan()})}async init(){this.blockElements=Array.from(document.querySelectorAll(".block"));try{const i=await(await fetch(g)).json();for(const e of i){const s=M(this.canvasWidth,this.canvasHeight,this.clouds,e.thought);this.clouds.push(s),this.sky.appendChild(s.element)}}catch(t){console.error("Failed to fetch thoughts:",t)}}getBlockBounds(){return this.blockElements.map(t=>{const i=t.getBoundingClientRect();return{left:i.left-this.panX,right:i.right-this.panX,top:i.top-this.panY,bottom:i.bottom-this.panY}})}setupPanning(){this.viewport.addEventListener("mousedown",t=>{(t.target.id==="viewport"||t.target.id==="sky")&&(this.isPanning=!0,this.panStartX=t.clientX-this.panX,this.panStartY=t.clientY-this.panY,this.viewport.classList.add("panning"),t.preventDefault())}),document.addEventListener("mousemove",t=>{if(this.isPanning){this.panX=t.clientX-this.panStartX,this.panY=t.clientY-this.panStartY;const i=0,e=-(this.canvasWidth-window.innerWidth),s=0,o=-(this.canvasHeight-window.innerHeight);this.panX=Math.max(e,Math.min(i,this.panX)),this.panY=Math.max(o,Math.min(s,this.panY)),this.updatePan()}}),document.addEventListener("mouseup",()=>{this.isPanning&&(this.isPanning=!1,this.viewport.classList.remove("panning"))})}updatePan(){this.sky.style.transform=`translate(${this.panX}px, ${this.panY}px)`}setupResizeHandler(){window.addEventListener("resize",()=>{this.canvasWidth=window.innerWidth*3,this.canvasHeight=window.innerHeight*3;const t=-(this.canvasWidth-window.innerWidth),i=-(this.canvasHeight-window.innerHeight);this.panX=Math.max(t,Math.min(0,this.panX)),this.panY=Math.max(i,Math.min(0,this.panY)),this.updatePan();for(const e of this.clouds)e.x+e.width>this.canvasWidth&&(e.x=this.canvasWidth-e.width),e.y+e.height>this.canvasHeight&&(e.y=this.canvasHeight-e.height),e.updatePosition()})}startAnimationLoop(){const t=()=>{const i=this.getBlockBounds();for(const e of this.clouds)e.isDragging||(e.update(),X(e,this.canvasWidth,this.canvasHeight),Y(e,i),e.updatePosition());requestAnimationFrame(t)};requestAnimationFrame(t)}}function H(){const n=document.getElementById("splash"),t=document.getElementById("thought-input"),i=document.getElementById("submit-thought");!n||!t||!i||(t.addEventListener("input",()=>{i.disabled=t.value.trim().length===0}),i.addEventListener("click",async()=>{const e=t.value.trim();if(e){i.disabled=!0,i.textContent="Submitting...";try{await fetch(g,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({thought:e})})}catch(s){console.error("Failed to submit thought:",s)}n.classList.add("hidden"),new L}}))}H();
