var x=Object.defineProperty;var b=(i,t,n)=>t in i?x(i,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[t]=n;var a=(i,t,n)=>b(i,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&e(h)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function e(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();class P{constructor(t,n,e,s,o="I am a cloud"){a(this,"x");a(this,"y");a(this,"vx");a(this,"vy");a(this,"width");a(this,"height");a(this,"element");a(this,"isDragging",!1);a(this,"dragOffsetX",0);a(this,"dragOffsetY",0);this.x=t,this.y=n,this.vx=e,this.vy=s,this.width=600,this.height=480,this.element=document.createElement("div"),this.element.className="cloud",this.element.style.width=`${this.width}px`,this.element.style.height=`${this.height}px`,this.element.style.cursor="grab";const h=document.createElement("div");h.className="cloud-body",h.style.top="180px",this.element.appendChild(h);for(let r=1;r<=5;r++){const d=document.createElement("div");d.className=`cloud-puff cloud-puff-${r}`,this.element.appendChild(d)}const c=document.createElement("span");c.className="cloud-text",c.textContent=o,this.element.appendChild(c),this.setupDragging(),this.updatePosition()}setupDragging(){this.element.addEventListener("mousedown",t=>{this.isDragging=!0,this.dragOffsetX=t.clientX-this.x,this.dragOffsetY=t.clientY-this.y,this.element.style.cursor="grabbing",t.preventDefault()}),document.addEventListener("mousemove",t=>{this.isDragging&&(this.x=t.clientX-this.dragOffsetX,this.y=t.clientY-this.dragOffsetY,this.updatePosition())}),document.addEventListener("mouseup",()=>{this.isDragging&&(this.isDragging=!1,this.element.style.cursor="grab")})}updatePosition(){this.element.style.transform=`translate(${this.x}px, ${this.y}px)`}update(){this.x+=this.vx,this.y+=this.vy,this.updatePosition()}getBounds(){return{left:this.x,right:this.x+this.width,top:this.y,bottom:this.y+this.height}}}function M(i,t,n,e){let r,d,l=0;const g=100;do r=Math.random()*(i-600),d=Math.random()*(t-480),l++;while(l<g&&n.some(u=>{const y=Math.abs(u.x-r),w=Math.abs(u.y-d);return y<650&&w<530}));const p=Math.random()*Math.PI*2,m=.15+Math.random()*(.4-.15),f=Math.cos(p)*m,v=Math.sin(p)*m;return new P(r,d,f,v,e)}function X(i,t,n){const e=i.getBounds();e.left<=0&&(i.x=0,i.vx=Math.abs(i.vx)),e.right>=t&&(i.x=t-i.width,i.vx=-Math.abs(i.vx)),e.top<=0&&(i.y=0,i.vy=Math.abs(i.vy)),e.bottom>=n&&(i.y=n-i.height,i.vy=-Math.abs(i.vy))}function Y(i,t){const n=i.getBounds();for(const e of t){const s=n.left<e.right&&n.right>e.left,o=n.top<e.bottom&&n.bottom>e.top;if(s&&o){const h=n.right-e.left,c=e.right-n.left,r=n.bottom-e.top,d=e.bottom-n.top,l=Math.min(h,c,r,d);l===h?(i.x=e.left-i.width,i.vx=-Math.abs(i.vx)):l===c?(i.x=e.right,i.vx=Math.abs(i.vx)):l===r?(i.y=e.top-i.height,i.vy=-Math.abs(i.vy)):(i.y=e.bottom,i.vy=Math.abs(i.vy))}}}const E="https://clouded-thoughts-backend-production.up.railway.app/thoughts";class H{constructor(){a(this,"clouds",[]);a(this,"sky");a(this,"viewport");a(this,"canvasWidth");a(this,"canvasHeight");a(this,"blockElements",[]);a(this,"panX",0);a(this,"panY",0);a(this,"isPanning",!1);a(this,"panStartX",0);a(this,"panStartY",0);const t=document.getElementById("sky"),n=document.getElementById("viewport");if(!t||!n)throw new Error("Required elements not found");this.sky=t,this.viewport=n,this.canvasWidth=window.innerWidth*3,this.canvasHeight=window.innerHeight*3,this.panX=-window.innerWidth,this.panY=-window.innerHeight,this.updatePan(),this.init(),this.setupPanning(),this.setupRecenterButton(),this.setupResizeHandler(),this.startAnimationLoop()}setupRecenterButton(){const t=document.getElementById("recenter-btn");t&&t.addEventListener("click",()=>{this.panX=-window.innerWidth,this.panY=-window.innerHeight,this.updatePan()})}async init(){this.blockElements=Array.from(document.querySelectorAll(".block"));try{const n=await(await fetch(E)).json();for(const e of n){const s=M(this.canvasWidth,this.canvasHeight,this.clouds,e.thought);this.clouds.push(s),this.sky.appendChild(s.element)}}catch(t){console.error("Failed to fetch thoughts:",t)}}getBlockBounds(){return this.blockElements.map(t=>{const n=t.getBoundingClientRect();return{left:n.left-this.panX,right:n.right-this.panX,top:n.top-this.panY,bottom:n.bottom-this.panY}})}setupPanning(){this.viewport.addEventListener("mousedown",t=>{(t.target.id==="viewport"||t.target.id==="sky")&&(this.isPanning=!0,this.panStartX=t.clientX-this.panX,this.panStartY=t.clientY-this.panY,this.viewport.classList.add("panning"),t.preventDefault())}),document.addEventListener("mousemove",t=>{if(this.isPanning){this.panX=t.clientX-this.panStartX,this.panY=t.clientY-this.panStartY;const n=0,e=-(this.canvasWidth-window.innerWidth),s=0,o=-(this.canvasHeight-window.innerHeight);this.panX=Math.max(e,Math.min(n,this.panX)),this.panY=Math.max(o,Math.min(s,this.panY)),this.updatePan()}}),document.addEventListener("mouseup",()=>{this.isPanning&&(this.isPanning=!1,this.viewport.classList.remove("panning"))})}updatePan(){this.sky.style.transform=`translate(${this.panX}px, ${this.panY}px)`}setupResizeHandler(){window.addEventListener("resize",()=>{this.canvasWidth=window.innerWidth*3,this.canvasHeight=window.innerHeight*3;const t=-(this.canvasWidth-window.innerWidth),n=-(this.canvasHeight-window.innerHeight);this.panX=Math.max(t,Math.min(0,this.panX)),this.panY=Math.max(n,Math.min(0,this.panY)),this.updatePan();for(const e of this.clouds)e.x+e.width>this.canvasWidth&&(e.x=this.canvasWidth-e.width),e.y+e.height>this.canvasHeight&&(e.y=this.canvasHeight-e.height),e.updatePosition()})}startAnimationLoop(){const t=()=>{const n=this.getBlockBounds();for(const e of this.clouds)e.isDragging||(e.update(),X(e,this.canvasWidth,this.canvasHeight),Y(e,n),e.updatePosition());requestAnimationFrame(t)};requestAnimationFrame(t)}}new H;
